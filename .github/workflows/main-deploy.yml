name: main-deploy

on:
  push:
    branches: [ main ]

jobs:

  main-docker-deploy:
    uses: ./.github/workflows/deploy-docker.yml
    with:
      image_name: "shortcake"
      tag: "latest"
      # TODO: secrets context does not appear to exist here? Luckily this isn't
      #       actually a secret
      # dockerhub_orgname: ${{ secrets.DOCKERHUB_ORG }}
      dockerhub_orgname: shortcakedev
      github_orgname: ${{ github.repository_owner }}
    secrets:
      dockerhub_username: ${{ secrets.DOCKERHUB_USERNAME }}
      dockerhub_token: ${{ secrets.DOCKERHUB_ACCESS_TOKEN }}
      gh_token: ${{ secrets.GITHUB_TOKEN }}
