name: dev-teardown

on:
  pull_request:
    types: [ converted_to_draft, closed ]

jobs:

  dev-docker-delete:
    # yamllint disable-line rule:line-length
    uses: shortcake-dev/shortcake/.github/workflows/delete-docker.yml@ae24cfa19c12e01895793d832eb2a1ce68e3b49c
    with:
      image_name: "shortcake"
      tag: "dev-pr${{ github.event.number }}"
      # TODO: secrets context does not appear to exist here? Luckily this isn't
      #       actually a secret
      # dockerhub_orgname: ${{ secrets.DOCKERHUB_ORG }}
      dockerhub_orgname: shortcakedev
      github_orgname: ${{ github.repository_owner }}
    secrets:
      dockerhub_username: ${{ secrets.DOCKERHUB_USERNAME }}
      dockerhub_password: ${{ secrets.DOCKERHUB_PASSWORD }}
      ghcr_pat: ${{ secrets.GH_PAT_SHORTCAKE_GHCR_ADMIN }}
